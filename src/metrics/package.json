{
  "name": "uproxy-metrics",
  "version": "1.0.0-beta",
  "author": "uProxy",
  "devDependencies": {
    "jasmine": "^2.4.1",
    "nodemon": "^1.10.2",
    "typescript": "^1.8.10",
    "typings": "^1.3.2"
  },
  "__comments": [
    "TODO: Remove node_modules_hack once AppEngine stops stripping node_modules/",
    "See https://stackoverflow.com/questions/37310253/how-to-force-app-engine-upload-node-modules/39028187"
  ],
  "scripts": {
    "install": "npm install --production adaptors/ metrics_server/ model/ tools/ && typings install",

    "build-server": "npm run build-clean && npm run tsc -- metrics_server/server.ts && ln -s ../node_modules/@uproxy-metrics/metrics_server/node_modules/ build/ && cp metrics_server/production/* build/",
    "build-tools":  "npm run build-clean && npm run tsc -- tools/*.ts && ln -s ../node_modules/@uproxy-metrics/tools/node_modules/ build/",
    "tsc": "tsc --module commonjs --target es6 --noImplicitAny --rootDir . --outDir build/ typings/index.d.ts",
    "build-clean": "rm -rf ./build",

    "test": "npm run tsc -- **/*.spec.ts && JASMINE_CONFIG_PATH=jasmine.json jasmine",
    "test-use-repository": "DATASTORE_EMULATOR_HOST=127.0.0.1:8081 node build/adaptors/datastore_use_events_repository_test.js",

    "clean": "npm run build-clean && npm run clean-install",
    "clean-install": "rm -rf ./node_modules ./typings",

    "env": "env",

    "datastore-start": "gcloud beta emulators datastore start --project=uproxy-metrics --no-legacy --no-store-on-disk --host-port=localhost:8081",
    "datastore-load": "DATASTORE_EMULATOR_HOST=127.0.0.1:8081 node build/tools/datastore_load_sample.js",
    "datastore-report": "DATASTORE_EMULATOR_HOST=127.0.0.1:8081 node build/tools/generate_report.js",

    "start": "DATASTORE_EMULATOR_HOST=127.0.0.1:8081 PORT=8080 node build/metrics_server/server.js",
    "monitor": "DATASTORE_EMULATOR_HOST=127.0.0.1:8081 PORT=8080 nodemon build/metrics_server/server.js",
    "deploy": "cd build && cp -R node_modules node_modules_hack && gcloud --project=uproxy-metrics app deploy"
  }
}
